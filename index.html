<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather API</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css
    "
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Krub:wght@300&family=Lato:wght@300;400&family=Montserrat&family=Open+Sans&family=Poppins&family=Raleway&family=Roboto&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Montserrat", sans-serif;
        background: #094d79;
      }

      body img {
        width: 7rem;
        display: block;
        margin: auto;
      }

      .font18px {
        font-size: 19px !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="row justify-content-center py-5">
        <div class="col-auto">
          <h1 class="text-light">Weather API</h1>
        </div>
      </div>
      <div class="row toBeAppendedRow justify-content-center">
        <div class="col-12 col-lg-auto">
          <select
            name=""
            id="cities"
            class="dropdown px-5 py-2 rounded-3 font18px"
          >
            <option class="dropdown-item px-3" value="">Select a city</option>
            <option class="dropdown-item px-3" value="london">London</option>
            <option class="dropdown-item px-3" value="denmark">Denmark</option>
            <option class="dropdown-item px-3" value="karachi">Karachi</option>
            <option class="dropdown-item px-3" value="lahore">Lahore</option>
            <option class="dropdown-item px-3" value="faisalabad">
              Faisalabad
            </option>
            <option class="dropdown-item px-3" value="tokyo">Tokyo</option>
          </select>
        </div>
      </div>
    </div>

   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js
"></script>

    <script>
      let cities = document.querySelector("#cities");
      let row = document.querySelector(".toBeAppendedRow");
      let newElement = document.createElement("div");
      let body = document.querySelector("body");

      let callingClass = new XMLHttpRequest();
      let weatherFunction = () => {
        let api = `https://api.openweathermap.org/data/2.5/weather?q=${cities.value}&appid=ea9167e1b2e498774e0ac4a8f85f6f01`;
        callingClass.open("GET", api);

        callingClass.onreadystatechange = () => {
          if (callingClass.readyState === 4) {
            let dataStored = JSON.parse(callingClass.responseText);
            let { name: city } = dataStored;
            let {
              weather: [{ main: weatherNow, description, icon }],
            } = dataStored;
            console.log(dataStored);
            let iconUrl =`https://openweathermap.org/img/wn/${icon}@2x.png`
            newElement.setAttribute("class","justify-content-center d-flex mt-3")
            newElement.innerHTML = ` <div class="col-12 col-lg-3 bg-light rounded-3">

              <div class="card rounded-3">


                <img src="${iconUrl}" alt="" class ="img-fluid">

      <div class="card-title mb-0 ">
        <h2 class="text-center mb-0">${weatherNow}</h2>
        <h6 class="text-center mb-0 mt-1 text-muted">(${city})</h6>

      </div>
      <div class="card-body">
        <p class="text-center pt-1 mb-0">${description}</p>
      </div>
    </div>
            
      </div>`;

            row.appendChild(newElement);
          }
        };

        callingClass.send();
      };

      cities.addEventListener("change", () => {
        switch (cities.value) {
          case "london":
            weatherFunction();
            break;

          case "denmark":
            weatherFunction();
            break;

          case "lahore":
            weatherFunction();
            break;

          case "faisalabad":
            weatherFunction();
            break;

          case "karachi":
            weatherFunction();
            break;

          case "tokyo":
            weatherFunction();
            break;
          default:
            break;
        }
      });
    </script>
  </body>
</html>
